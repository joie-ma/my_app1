{"ast":null,"code":"import _objectSpread from \"C:\\\\REACTSTUDY\\\\my-app2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"C:\\\\REACTSTUDY\\\\my-app2\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\REACTSTUDY\\\\my-app2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\REACTSTUDY\\\\my-app2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\REACTSTUDY\\\\my-app2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\REACTSTUDY\\\\my-app2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\REACTSTUDY\\\\my-app2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\REACTSTUDY\\\\my-app2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\REACTSTUDY\\\\my-app2\\\\src\\\\container\\\\course\\\\CourseInfo.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button } from \"antd\";\nimport actions from \"../../store/action\";\nimport qs from \"qs\";\nimport { getCourseInfo } from \"../../api/course\";\nimport { addCartList, removeCart } from \"../../api/cart\";\n\nvar CourseInfo =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CourseInfo, _Component);\n\n  // 放置构造函数和原型上的方法\n  function CourseInfo() {\n    var _this;\n\n    _classCallCheck(this, CourseInfo);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CourseInfo).call(this));\n\n    _this.getData =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(_ref) {\n        var courseID, res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                courseID = _ref.courseID;\n                _context.next = 3;\n                return getCourseInfo(courseID);\n\n              case 3:\n                res = _context.sent;\n\n                if (parseInt(res.code) === 0) {\n                  _this.setState({\n                    info: res.data\n                  });\n                } else {\n                  _this.setState({\n                    info: null\n                  });\n                }\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.getId = function () {\n      var str = _this.props.location.search;\n      var obj = qs.parse(str.slice(1)); //url-encode字符串形式改成对象\n\n      var courseID = obj.courseID;\n      return courseID;\n    };\n\n    _this.state = {\n      info: null\n    };\n    return _this;\n  }\n\n  _createClass(CourseInfo, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.props.cartList(); //同步redux\n      //获取地址栏中id\n\n      var courseID = this.getId();\n      this.getData(courseID);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var courseID = this.getId();\n      var n = this.props.list.find(function (item) {\n        return item.id === courseID;\n      });\n      return React.createElement(\"div\", {\n        className: \"course-info-box\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"con\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 41\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"info\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 42\n        },\n        __self: this\n      }, JSON.stringify(this.state.info)), n ? React.createElement(Button, {\n        type: \"primary\",\n        onClick:\n        /*#__PURE__*/\n        _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee2() {\n          var res;\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.next = 2;\n                  return removeCart({\n                    courseID: _this2.state.info.id\n                  });\n\n                case 2:\n                  res = _context2.sent;\n\n                  if (parseInt(res.code) === 0) {\n                    _this2.props.cartList();\n                  }\n\n                case 4:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        })),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45\n        },\n        __self: this\n      }, \"\\u4ECE\\u8D2D\\u7269\\u8F66\\u4E2D\\u79FB\\u9664\") : React.createElement(Button, {\n        type: \"primary\",\n        onClick:\n        /*#__PURE__*/\n        _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee3() {\n          var res;\n          return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n            while (1) {\n              switch (_context3.prev = _context3.next) {\n                case 0:\n                  _context3.next = 2;\n                  return addCartList({\n                    courseID: _this2.state.info.id\n                  });\n\n                case 2:\n                  res = _context3.sent;\n\n                  if (parseInt(res.code) === 0) {\n                    _this2.props.cartList();\n                  } //重新获取购物车里的数据\n\n\n                case 4:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }\n          }, _callee3, this);\n        })),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }, \"\\u52A0\\u5165\\u8D2D\\u7269\\u8F66\")));\n    }\n  }]);\n\n  return CourseInfo;\n}(Component);\n\nexport default connect(function (state) {\n  return _objectSpread({}, state.cart);\n}, actions.cart)(CourseInfo);","map":{"version":3,"sources":["C:\\REACTSTUDY\\my-app2\\src\\container\\course\\CourseInfo.js"],"names":["React","Component","connect","Button","actions","qs","getCourseInfo","addCartList","removeCart","CourseInfo","getData","courseID","res","parseInt","code","setState","info","data","getId","str","props","location","search","obj","parse","slice","state","cartList","n","list","find","item","id","JSON","stringify","cart"],"mappings":"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","sourcesContent":["import React,{Component} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {Button} from \"antd\";\r\nimport actions from \"../../store/action\";\r\nimport qs from \"qs\";\r\nimport {getCourseInfo} from \"../../api/course\";\r\nimport {addCartList,removeCart} from \"../../api/cart\";\r\nclass CourseInfo extends Component{\r\n    // 放置构造函数和原型上的方法\r\n    constructor(){\r\n        super();\r\n        this.state = {info:null};\r\n    }\r\n    getData = async ({courseID})=>{\r\n        let res = await getCourseInfo(courseID);\r\n        if (parseInt(res.code)===0){\r\n            this.setState({info:res.data})\r\n        } else{\r\n            this.setState({info:null})\r\n        }\r\n    };\r\n    getId=()=>{\r\n        let str = this.props.location.search;\r\n        let obj = qs.parse(str.slice(1));  //url-encode字符串形式改成对象\r\n        let courseID = obj.courseID;\r\n        return courseID;\r\n    };\r\n    componentWillMount(){\r\n        this.props.cartList();//同步redux\r\n        //获取地址栏中id\r\n        let courseID = this.getId();\r\n        this.getData(courseID);\r\n\r\n    }\r\n    render(){\r\n        let courseID = this.getId();\r\n        let n = this.props.list.find(item=>{\r\n            return item.id === courseID ;\r\n        });\r\n        return <div className=\"course-info-box\">\r\n            <div className=\"con\">\r\n                <div className=\"info\">\r\n                    {JSON.stringify(this.state.info)}\r\n                </div>\r\n                {n ? <Button type=\"primary\"\r\n                                          onClick={async ()=>{\r\n                                              let res = await removeCart({courseID:this.state.info.id});\r\n                                              if (parseInt(res.code) === 0){\r\n                                                  this.props.cartList();\r\n                                              }\r\n                                          }}>从购物车中移除</Button>\r\n                    :<Button type=\"primary\" onClick={async ()=>{\r\n                        let res = await addCartList({courseID: this.state.info.id});\r\n                        if (parseInt(res.code) === 0){\r\n                            this.props.cartList();\r\n                        } //重新获取购物车里的数据\r\n                    }}>加入购物车</Button>}\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\nexport default connect((state)=>({...state.cart}),actions.cart)(CourseInfo);"]},"metadata":{},"sourceType":"module"}